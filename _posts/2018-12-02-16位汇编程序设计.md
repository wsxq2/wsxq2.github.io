---
tags: [masm, æ±‡ç¼–, 8086]
last_modified_time: 2019-04-19 12:41:09 +0800
---

<p id="markdown-toc"></p>
<!-- vim-markdown-toc GFM -->

* [ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ±‡ç¼–è¯­è¨€ï¼Ÿ](#ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ±‡ç¼–è¯­è¨€)
* [Intelå¤„ç†å™¨ä½“ç³»ç»“æ„çš„å‘å±•](#intelå¤„ç†å™¨ä½“ç³»ç»“æ„çš„å‘å±•)
* [å•æ ¸å¤„ç†å™¨ 8086](#å•æ ¸å¤„ç†å™¨-8086)
  * [ä¸ºä»€ä¹ˆé€‰æ‹© 8086](#ä¸ºä»€ä¹ˆé€‰æ‹©-8086)
  * [8086 ç®€ä»‹](#8086-ç®€ä»‹)
  * [ä½“ç³»ç»“æ„](#ä½“ç³»ç»“æ„)
  * [å¯„å­˜å™¨ç»“æ„](#å¯„å­˜å™¨ç»“æ„)
  * [ä¸»å­˜ç»“æ„](#ä¸»å­˜ç»“æ„)
    * [åŒä½“](#åŒä½“)
    * [åˆ†æ®µ](#åˆ†æ®µ)
  * [å·¥ä½œè¿‡ç¨‹](#å·¥ä½œè¿‡ç¨‹)
* [8086 æ±‡ç¼–ç¨‹åºè®¾è®¡](#8086-æ±‡ç¼–ç¨‹åºè®¾è®¡)
  * [Hello World ç¨‹åº](#hello-world-ç¨‹åº)
    * [å®Œæ•´æ®µå®šä¹‰çš„ç¨‹åºç»“æ„](#å®Œæ•´æ®µå®šä¹‰çš„ç¨‹åºç»“æ„)
    * [ç®€åŒ–æ®µå®šä¹‰çš„ç¨‹åºç»“æ„](#ç®€åŒ–æ®µå®šä¹‰çš„ç¨‹åºç»“æ„)
  * [å…³é”®æ¦‚å¿µ](#å…³é”®æ¦‚å¿µ)
  * [MASM](#masm)
  * [ç¼–è¯‘ã€é“¾æ¥å’Œè¿è¡Œç¨‹åº](#ç¼–è¯‘é“¾æ¥å’Œè¿è¡Œç¨‹åº)
    * [è¿‡ç¨‹](#è¿‡ç¨‹)
    * [æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆï¼Ÿ](#æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆ)
  * [åŸºæœ¬å…ƒç´ ](#åŸºæœ¬å…ƒç´ )
    * [æ•´æ•°å¸¸é‡](#æ•´æ•°å¸¸é‡)
    * [å­—ç¬¦ã€å­—ç¬¦ä¸²å¸¸é‡](#å­—ç¬¦å­—ç¬¦ä¸²å¸¸é‡)
    * [ç®—æœ¯è¿ç®—ç¬¦](#ç®—æœ¯è¿ç®—ç¬¦)
    * [ä¿ç•™å­—](#ä¿ç•™å­—)
    * [æ ‡è¯†ç¬¦](#æ ‡è¯†ç¬¦)
    * [æŒ‡ä»¤](#æŒ‡ä»¤)
    * [æ•°æ®å®šä¹‰](#æ•°æ®å®šä¹‰)
    * [ç¬¦å·å¸¸é‡](#ç¬¦å·å¸¸é‡)
  * [æ•°æ®ä¼ é€æŒ‡ä»¤â€”â€” MOV ç±»æŒ‡ä»¤](#æ•°æ®ä¼ é€æŒ‡ä»¤-mov-ç±»æŒ‡ä»¤)
    * [æ“ä½œæ•°ç±»å‹](#æ“ä½œæ•°ç±»å‹)
    * [ç›´æ¥å†…å­˜æ“ä½œæ•°](#ç›´æ¥å†…å­˜æ“ä½œæ•°)
    * [`MOV`](#mov)
    * [`MOVZX`](#movzx)
    * [`MOVSX`](#movsx)
    * [`XCHG`](#xchg)
  * [åŠ å‡æ³•ç±»æŒ‡ä»¤](#åŠ å‡æ³•ç±»æŒ‡ä»¤)
    * [`INC`å’Œ`DEC`](#incå’Œdec)
    * [`ADD`](#add)
    * [`SUB`](#sub)
    * [`NEG`](#neg)
    * [æ ‡å¿—ä½](#æ ‡å¿—ä½)
    * [ä¾‹å­ç¨‹åº](#ä¾‹å­ç¨‹åº)
  * [å’Œæ•°æ®ç›¸å…³çš„æ“ä½œç¬¦](#å’Œæ•°æ®ç›¸å…³çš„æ“ä½œç¬¦)
    * [`OFFSET`](#offset)
    * [`PTR`](#ptr)
    * [`TYPE`](#type)
    * [`LENGTHOF`](#lengthof)
    * [`SIZEOF`](#sizeof)
  * [é—´æ¥å¯»å€](#é—´æ¥å¯»å€)
    * [é—´æ¥æ“ä½œæ•°ï¼ˆå¯„å­˜å™¨é—´æ¥å¯»å€ï¼‰](#é—´æ¥æ“ä½œæ•°å¯„å­˜å™¨é—´æ¥å¯»å€)
    * [å˜å€æ“ä½œæ•°ï¼ˆå¯„å­˜å™¨ç›¸å¯¹å¯»å€ï¼‰](#å˜å€æ“ä½œæ•°å¯„å­˜å™¨ç›¸å¯¹å¯»å€)
  * [JMPå’ŒLOOPæŒ‡ä»¤](#jmpå’ŒloopæŒ‡ä»¤)
    * [`JMP`](#jmp)
    * [`LOOP`](#loop)
  * [è¿‡ç¨‹â€”â€” PROC ç›¸å…³æŒ‡ä»¤](#è¿‡ç¨‹-proc-ç›¸å…³æŒ‡ä»¤)
    * [ä¸å¤–éƒ¨åº“é“¾æ¥](#ä¸å¤–éƒ¨åº“é“¾æ¥)
* [ç»å…¸ä¾‹å­](#ç»å…¸ä¾‹å­)
  * [æ•´æ•°æ•°ç»„æ±‚å’Œ](#æ•´æ•°æ•°ç»„æ±‚å’Œ)
  * [æ‹·è´å­—ç¬¦ä¸²](#æ‹·è´å­—ç¬¦ä¸²)
* [é“¾æ¥](#é“¾æ¥)
* [ç¼©ç•¥è¯­](#ç¼©ç•¥è¯­)

<!-- vim-markdown-toc -->

## ä¸ºä»€ä¹ˆè¦å­¦ä¹ æ±‡ç¼–è¯­è¨€ï¼Ÿ
> * åµŒå…¥å¼ç³»ç»Ÿï¼šåœ¨ç‰¹å®šç¡¬ä»¶ä¸‹ï¼Œå¯¹ç¨‹åºçš„å¤§å°å’Œè¿è¡Œé€Ÿåº¦éœ€è¦é«˜åº¦ä¼˜åŒ–çš„æƒ…å†µã€‚
> * é©±åŠ¨ç¨‹åºçš„è®¾è®¡è€…ï¼›æ“ä½œç³»ç»Ÿå†…æ ¸çš„è®¾è®¡è€…ï¼›ç¼–è¯‘ç¨‹åºçš„è®¾è®¡è€…ã€‚
> * æœ‰åŠ©äºå¯¹è®¡ç®—æœºç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºä¹‹é—´äº¤äº’çš„æ•´ä½“ç†è§£ã€‚
> * çªç ´é«˜çº§è¯­è¨€çš„å±€é™ï¼šé«˜çº§è¯­è¨€ä¸­åµŒå…¥æ±‡ç¼–ã€‚

æ±‡ç¼–è¯­è¨€é€šå¸¸åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ’åç¬¬10å·¦å³

## Intelå¤„ç†å™¨ä½“ç³»ç»“æ„çš„å‘å±•
å¤„ç†å™¨å¾®ä½“ç³»ç»“æ„å†³å®šäº†å¤„ç†å™¨çš„æ€§èƒ½ã€æˆæœ¬ç­‰æŒ‡æ ‡ï¼Œæ•…å…¶ä½“ç³»ç»“æ„åœ¨ä¸æ–­åœ°å‘å±•å˜åŒ–ã€‚

| å¹´ä»½      | å¾®å¤„ç†å™¨å‹å·                 | ä½“ç³»ç»“æ„                                   |
|-----------|------------------------------|--------------------------------------------|
| 1978      | 8086                         | Intel IA-32æ¶æ„å…ˆå¯¼ï¼Œç¬¬1ä¸ª16ä½å¤„ç†å™¨       |
| 1985      | 80386                        | Intel IA-32æ¶æ„ï¼Œç¬¬1ä¸ª32ä½å¤„ç†å™¨           |
| 1995-1999 | P6å®¶æ—                       | Intel IA-32æ¶æ„ï¼ˆè¶…æ ‡é‡å¾®ä½“ç³»ç»“æ„ï¼‰        |
| 2000-2006 | Pentium 4                    | Intel IA-32æ¶æ„(NetBurstå¾®ä½“ç³»ç»“æ„)        |
|           | Pentium 4ï¼ˆ6xxã€5xxï¼‰        | Intel 64æ¶æ„                               |
| 2003      | Pentium M                    | å¢å¼ºçš„Intel IA-32ç§»åŠ¨æ¶æ„                  |
| 2005-2007 | Pentium Extreme              | Intel 64æ¶æ„(NetBurstå¾®ä½“ç³»ç»“æ„)           |
| 2006-2007 | Core Duo                     | å¢å¼ºçš„Pentium Må¾®ä½“ç³»ç»“æ„                  |
| 2006      | PentiumåŒæ ¸ï¼ŒCore 2 Duo      | Intel 64æ¶æ„(Coreå¾®ä½“ç³»ç»“æ„ï¼Œ65nm)         |
| 2007      | Core 2 Duo E8000ï¼ŒQuad Q9000 | Intel 64æ¶æ„(å¢å¼ºCoreå¾®ä½“ç³»ç»“æ„ï¼Œ45nm)     |
| 2008      | Atom                         | Intel 64æ¶æ„(Atomå¾®ä½“ç³»ç»“æ„ï¼Œ45nm)         |
| 2008      | Core i7 900                  | Intel 64æ¶æ„(Nehalemå¾®ä½“ç³»ç»“æ„ï¼Œ45nm)      |
| 2010      | Core i7ã€i5ã€i3              | Intel 64æ¶æ„(Westmereå¾®ä½“ç³»ç»“æ„ï¼Œ32nm)     |
| 2011      | ç¬¬äºŒä»£Core i7ã€i5ã€i3        | Intel 64æ¶æ„(Sandy Bridgeå¾®ä½“ç³»ç»“æ„ï¼Œ32nm) |
| 2012      | ç¬¬ä¸‰ä»£Core i7ã€i5ã€i3        | Intel 64æ¶æ„(Ivy Bridgeå¾®ä½“ç³»ç»“æ„ï¼Œ22nm)   |
| 2013      | ç¬¬å››ä»£Core i7ã€i5ã€i3        | Intel 64æ¶æ„(Haswellå¾®ä½“ç³»ç»“æ„ï¼Œ22nm)      |
| 2015      | ç¬¬äº”ä»£Core i7ã€i5ã€i3        | Intel 64æ¶æ„(Broadwellå¾®ä½“ç³»ç»“æ„ï¼Œ14nm)    |
  
å…¶å˜åŒ–å†…å®¹å¤§è‡´å¦‚ä¸‹ï¼š

* ä¸»å­˜åˆ†æ®µ
* å¯„å­˜å™¨ç»“æ„
* ä¸»å­˜å¯»å€ç©ºé—´
* å¤–éƒ¨æ€»çº¿å®½åº¦
* æ›´å®½çš„å†…éƒ¨æ•°æ®é€šè·¯
* ä¿æŠ¤æ¨¡å¼
  * åˆ†æ®µå­˜å‚¨æ¨¡å‹
  * å¹³å¦å­˜å‚¨æ¨¡å‹
  * åˆ†é¡µè™šå­˜ç®¡ç†
* æµæ°´çº¿æŠ€æœ¯
  * è¶…æ ‡é‡
  * åˆ†æ”¯é¢„æµ‹
  * åŠ¨æ€æ‰§è¡Œ/æ¨æµ‹æ‰§è¡Œ/ä¹±åº
* é«˜é€Ÿç¼“å­˜æŠ€æœ¯ï¼›Smart Cache
* æ‰©å±•æŒ‡ä»¤é›†
* è¶…çº¿ç¨‹æŠ€æœ¯ï¼›å¤šæ ¸æŠ€æœ¯
* ç¡¬ä»¶è™šæ‹ŸåŒ–æŠ€æœ¯
* é›†æˆçš„å¤šé€šé“å­˜å‚¨æ§åˆ¶å™¨
* QPI
* é›†æˆçš„å›¾å½¢å¤„ç†å•å…ƒ
* Turbo Boost
* ç¯å½¢å†…éƒ¨æ€»çº¿ï¼ˆç¬¬äºŒä»£Core i7ã€i5ã€i3ï¼‰
* 16ä½â†’32ä½â†’64ä½
* åˆ¶é€ å·¥è‰ºï¼š65nmâ†’45nmâ†’32nmâ†’22nmâ†’14nm

## å•æ ¸å¤„ç†å™¨ 8086
### ä¸ºä»€ä¹ˆé€‰æ‹© 8086
* å•æ ¸å¤„ç†å™¨æ˜¯å¤šæ ¸å¤„ç†å™¨çš„åŸºç¡€ã€‚
* ä»8086 CPUå¼€å§‹ï¼ŒIntel CPUè®¾è®¡é‡‡ç”¨äº†å‘åå…¼å®¹ï¼ˆbackward compatibilityï¼Œä¹Ÿç§°ä½œå‘ä¸‹å…¼å®¹Downward Compatibilityï¼‰çš„ç‰¹æ€§ã€‚
* å•æ ¸çš„8086 CPUæˆä¸ºå…¶åIntel CPUçš„åŸºçŸ³ã€‚

### 8086 ç®€ä»‹
* 8086 CPUæœ‰ä¸‰ä¸ªç‰ˆæœ¬ï¼š8086ã€8086-2ã€8086-1ï¼Œä»…æ—¶é’Ÿé¢‘ç‡ä¸åŒï¼Œä¾æ¬¡ä¸º5Mhzã€8Mhzã€10Mhzã€‚
* 8086 CPUå…·æœ‰å¦‚ä¸‹åŠŸèƒ½ç‰¹æ€§ï¼š
  * ç›´æ¥ä¸»å­˜å¯»å€èƒ½åŠ›1MBï¼›
  * ä½“ç³»ç»“æ„æ˜¯é’ˆå¯¹å¼ºå¤§çš„æ±‡ç¼–è¯­è¨€å’Œæœ‰æ•ˆçš„é«˜çº§è¯­è¨€è®¾è®¡çš„ï¼›
  * 14ä¸ª16ä½å¯„å­˜å™¨ï¼›
  * 24ç§æ“ä½œæ•°å¯»å€æ–¹å¼ï¼›
  * æ“ä½œæ•°ç±»å‹ï¼šä½ã€å­—èŠ‚ã€å­—å’Œå—ï¼›
  * 8ã€16ä½æ— ç¬¦å·å’Œå¸¦ç¬¦å·äºŒè¿›åˆ¶æˆ–åè¿›åˆ¶è¿ç®—ï¼ŒåŒ…æ‹¬ä¹˜æ³•å’Œé™¤æ³•ã€‚
* ç‰¹ç‚¹ï¼š
  * å®åœ°å€æ¨¡å¼
  * å°ç«¯å­˜å‚¨ï¼ˆåå¸¸è¯†ï¼‰ï¼Œå¦‚ 5678H è¡¨å¼ä¸º 7856H

### ä½“ç³»ç»“æ„
![8086å¤„ç†å™¨ä½“ç³»ç»“æ„.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/8086å¤„ç†å™¨ä½“ç³»ç»“æ„.png)

* æ€»çº¿æ¥å£å•å…ƒBIUï¼ˆBus Interface Unitï¼‰: è´Ÿè´£ä¸å­˜å‚¨å™¨ã€I/Oæ¥å£ä¼ é€’æ•°æ®ï¼Œå…·ä½“å®Œæˆï¼š
  * ä»å†…å­˜å–æŒ‡ä»¤ï¼Œé€åˆ°æŒ‡ä»¤é˜Ÿåˆ—
  * é…åˆEUä»æŒ‡å®šçš„å†…å­˜å•å…ƒæˆ–IOç«¯å£å–æ•°æ®
  * å°†EUçš„æ“ä½œç»“æœé€åˆ°æŒ‡å®šçš„å†…å­˜å•å…ƒæˆ–IOç«¯å£
* æ‰§è¡Œå•å…ƒEUï¼ˆExecute Unitï¼‰ï¼šè´Ÿè´£æŒ‡ä»¤çš„æ‰§è¡Œï¼ˆç®—æœ¯ã€é€»è¾‘ã€ç§»ä½è¿ç®—ï¼Œæœ‰æ•ˆåœ°å€è®¡ç®—ï¼Œæ§åˆ¶å‘½ä»¤ã€â€¦â€¦ï¼‰

ç”±äºæœ‰æŒ‡ä»¤é˜Ÿåˆ—ï¼ŒBIUå’ŒEUå¯å¹¶è¡Œå·¥ä½œ


### å¯„å­˜å™¨ç»“æ„
![å¯„å­˜å™¨ç»“æ„.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/å¯„å­˜å™¨ç»“æ„.png)
å…¶ä¸­å„å¯„å­˜å™¨è¯´æ˜å¦‚ä¸‹ï¼š
![å¯„å­˜å™¨ç»“æ„è¯´æ˜.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/å¯„å­˜å™¨ç»“æ„è¯´æ˜.png)

é€šç”¨å¯„å­˜å™¨ï¼šä¸»è¦ç”¨äºç®—æœ¯è¿ç®—å’Œæ•°æ®ä¼ é€ã€‚
* æ¯ä¸ªå¯„å­˜å™¨å¯ä½œ32ä½æˆ–16ä½ä½¿ç”¨ã€‚
* ä¸€äº›16ä½çš„å¯„å­˜å™¨ä¹Ÿå¯ä»¥ä½œä¸ºä¸¤ä¸ªå•ç‹¬çš„8ä½ä½¿ç”¨ã€‚
* å…¶ä½™é€šç”¨å¯„å­˜å™¨çš„ä½16ä½æœ‰ç‹¬ç«‹çš„åå­—ï¼Œä½†ä¸èƒ½è¿›ä¸€æ­¥ç»†åˆ†ã€‚ä¸‹é¢åˆ—å‡ºçš„16ä½å¯„å­˜å™¨é€šå¸¸åªåœ¨ç¼–å†™è¿è¡Œäºå®åœ°å€æ¨¡å¼ï¼ˆ8086åªæœ‰å®åœ°å€æ¨¡å¼ï¼Œä¿æŠ¤æ¨¡å¼é¦–æ¬¡å‡ºç°åœ¨80386ä¸­ï¼‰ä¸‹çš„ç¨‹åºæ—¶æ‰ä½¿ç”¨ã€‚

  | 32ä½ | 16ä½ | é«˜8ä½ | ä½8ä½ |
  |------+------+-------+-------|
  | EAX  | AX   | AH    | AL    |
  | EBX  | BX   | BH    | BL    |
  | ECX  | CX   | CH    | CL    |
  | EDX  | DX   | DH    | DL    |
  
  
  | 32ä½ | 16ä½ |
  |------+------|
  | ESI  | SI   |
  | EDI  | DI   |
  | EBP  | BP   |
  | ESP  | SP   |

### ä¸»å­˜ç»“æ„
#### åŒä½“
æ—¢å¯ä»¥å®ç°16ä½å­˜å‚¨ï¼Œä¹Ÿå¯ä»¥å®ç°8ä½å­˜å‚¨ã€‚
![ä¸»å­˜çš„åŒä½“ç»“æ„.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/ä¸»å­˜çš„åŒä½“ç»“æ„.png)

#### åˆ†æ®µ
```
ç‰©ç†åœ°å€ = æ®µåœ°å€*16+æ®µå†…åç§»åœ°å€
```
ä¾‹å¦‚ï¼šå½¢å¼åœ°å€6832H:1280H â†’ ç‰©ç†åœ°å€ï¼Ÿï¼ˆ68320H + 1280H = 695A0Hï¼‰

ä¼˜ç‚¹ï¼š
* ä»£ç ã€æ•°æ®é‡ä¸å¤§ â†’ ä½¿å…¶å¤„äºåŒä¸€æ®µå†…ï¼ˆ64KBèŒƒå›´å†…ï¼‰â†’ å¯å‡å°‘æŒ‡ä»¤é•¿åº¦ã€æé«˜è¿è¡Œé€Ÿåº¦ã€‚
* å†…å­˜åˆ†æ®µä¸ºç¨‹åºçš„æµ®åŠ¨åˆ†é…åˆ›é€ äº†æ¡ä»¶ã€‚
* **å„ä¸ªåˆ†æ®µä¹‹é—´å¯ä»¥é‡å **ã€‚

8086 CPU æ‰§è¡Œç¨‹åºæ—¶ï¼Œå½“å‰æŒ‡ä»¤çš„å­˜å‚¨åœ°å€ä¸º(CS)Ã—16ï¼‹(IP)ã€‚å½“CSä¸å˜ã€IPå•ç‹¬æ”¹å˜æ—¶ï¼Œä¼šå‘ç”Ÿæ®µå†…çš„ç¨‹åºè½¬ç§»ï¼›å½“CSæ”¹å˜æ—¶ï¼Œä¼šå‘ç”Ÿæ®µé—´çš„ç¨‹åºè½¬ç§»ã€‚

æ®µå¯„å­˜å™¨çš„ä½¿ç”¨çº¦å®šå¦‚ä¸‹ï¼š
![ä¸»å­˜çš„åˆ†æ®µç»“æ„ä¹‹æ®µå¯„å­˜å™¨çš„ä½¿ç”¨.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/ä¸»å­˜çš„åˆ†æ®µç»“æ„ä¹‹æ®µå¯„å­˜å™¨çš„ä½¿ç”¨.png)

ä¸»å­˜ç»“æ„å¦‚ä¸‹ï¼š
![ä¸»å­˜ç»“æ„.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/ä¸»å­˜ç»“æ„.png)

### å·¥ä½œè¿‡ç¨‹
åº”ç”¨ç¨‹åº->OSå‡½æ•°->BIOSåŠŸèƒ½->ç¡¬ä»¶

> ä¾‹å¦‚ï¼Œåœ¨æ˜¾ç¤ºå™¨ä¸Šæ˜¾ç¤ºä¸€ä¸ªç‰¹å®šé¢œè‰²å­—ç¬¦ä¸²ï¼š
> 1. åº”ç”¨ç¨‹åºè°ƒç”¨ä¸€ä¸ªåº“å‡½æ•°å‘æ ‡å‡†è¾“å‡ºä¸Šå†™å­—ç¬¦ä¸²ã€‚
> 1. åº“å‡½æ•°(å±‚æ¬¡3)è°ƒç”¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿå‡½æ•°ï¼Œä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‡é’ˆã€‚
> 1. æ“ä½œç³»ç»Ÿå‡½æ•°(å±‚æ¬¡2)é‡å¤è°ƒç”¨BIOSçš„æŸä¸ªåŠŸèƒ½ï¼Œå‘å®ƒä¼ é€’ASCIIç åŠæ¯ä¸ªå­—ç¬¦çš„é¢œè‰²ï¼Œæ“ä½œç³»ç»Ÿè°ƒç”¨å¦å¤–ä¸€ä¸ªBIOSåŠŸèƒ½å°†å…‰æ ‡å‰è¿›åˆ°å±å¹•çš„ä¸‹ä¸€ä¸ªå­—ç¬¦ä½ç½®ã€‚
> 1. BIOSåŠŸèƒ½(å±‚æ¬¡1)æ¥æ”¶æ¯ä¸ªå­—ç¬¦ï¼Œå°†å…¶æ˜ å°„ä¸ºç‰¹å®šçš„ç³»ç»Ÿå­—ä½“ï¼Œç„¶åæŠŠå­—ç¬¦é€è‡³ä¸è§†é¢‘æ§åˆ¶å¡ç›¸è¿çš„ç¡¬ä»¶ç«¯å£ã€‚
> 1. è§†é¢‘æ§åˆ¶å¡(å±‚æ¬¡0)å®šæ—¶äº§ç”Ÿç¡¬ä»¶ä¿¡å·ç»™æ˜¾ç¤ºå™¨ä»¥æ§åˆ¶å…‰æ …æ‰«æå’Œè±¡ç´ æ˜¾ç¤ºã€‚

## 8086 æ±‡ç¼–ç¨‹åºè®¾è®¡
### Hello World ç¨‹åº
#### å®Œæ•´æ®µå®šä¹‰çš„ç¨‹åºç»“æ„
```
stack	segment stack
		db 100 dup (?)
stack	ends
data	segment
		message db 'Hello, world',0dh,0ah,'$'
data	ends
code	segment
		assume cs:code,ds:data,ss:stack
start:
		mov  ax,data
		mov  ds,ax

		mov  ah,9
		mov  dx,offset message
		int  21h

		mov  ah,4ch
		int  21h
code	ends
		end start
```

å…¶ä¸­ï¼š
* å®Œæ•´æ®µå®šä¹‰ï¼š
  ```
  æ®µå	SEGMENT [å¯¹é½æ–¹å¼] [ç»„åˆæ–¹å¼] ['ç±»']
      	è¯­å¥
  æ®µå 	ENDS
  ```
  æ®µåï¼šæ ‡è¯†æ®µçš„åå­—ï¼ŒæƒŸä¸€çš„æˆ–å·²å­˜åœ¨çš„ã€‚
  å¯¹é½æ–¹å¼ï¼šå¯ä»¥æ˜¯ BYTEã€WORDã€DWORDã€PARAã€PAGEã€‚
  ç»„åˆæ–¹å¼ï¼šå¯ä»¥æ˜¯ PRIVATEã€PUBLICã€STACKã€COMMONã€MEMORYã€ATåœ°å€ã€‚
  ç±»ï¼šç”¨äºæ ‡è¯†ç‰¹å®šç±»å‹æ®µçš„åå­—ï¼Œå¦‚CODEã€STACKç­‰ã€‚
  
* ASSUMEä¼ªæŒ‡ä»¤ï¼šå‘Šè¯‰æ±‡ç¼–ç¨‹åºï¼Œå“ªä¸€ä¸ªæ®µå’Œå“ªä¸€ä¸ªæ®µå¯„å­˜å™¨ç›¸å¯¹åº”ï¼Œå³æŸä¸€æ®µåœ°å€åº”æ”¾å…¥å“ªä¸€ä¸ªæ®µå¯„å­˜å™¨ã€‚
* æ“ä½œç³»ç»Ÿçš„è£…å…¥ç¨‹åºåœ¨è£…å…¥æ‰§è¡Œæ—¶ï¼ŒæŠŠCSåˆå§‹åŒ–æˆæ­£ç¡®çš„ä»£ç æ®µåœ°å€ï¼ŒæŠŠSSåˆå§‹åŒ–ä¸ºæ­£ç¡®çš„å †æ ˆæ®µåœ°å€ï¼Œå› æ­¤æºç¨‹åºä¸­æ— å†éœ€åˆå§‹åŒ–CSã€SSã€‚
* è£…å…¥ç¨‹åºå·²å°†DSå¯„å­˜å™¨ç•™ä½œå®ƒç”¨ï¼Œæ•…åœ¨æºç¨‹åºä¸­åº”æœ‰ä»¥ä¸‹ä¸¤æ¡æŒ‡ä»¤ï¼š	
          MOV AX,DATA
  				MOV DS,AX
* DOSç¯å¢ƒä¸‹ï¼Œæ±‡ç¼–è¯­è¨€è¿”å›DOSï¼š
  				MOV AH,4CH
  				INT 21H


#### ç®€åŒ–æ®µå®šä¹‰çš„ç¨‹åºç»“æ„

```
.model small,stdcall			            ;å­˜å‚¨æ¨¡å‹ï¼šå°å‹
.stack 100          		              ;å®šä¹‰å †æ ˆæ®µåŠå…¶å¤§å°
.data               	                ;å®šä¹‰æ•°æ®æ®µ
message db 'Hello, world',0dh,0ah,'$' ;æ•°æ®å£°æ˜
.code                                 ;å®šä¹‰ä»£ç æ®µ
start:                                ;èµ·å§‹æ‰§è¡Œåœ°å€æ ‡å·
		mov  ax,data                      ;æ•°æ®æ®µåœ°å€
		mov  ds,ax                        ;å­˜å…¥æ•°æ®æ®µå¯„å­˜å™¨
                                      ;å…·ä½“ç¨‹åºä»£ç 
		mov  ah,9                                           
		mov  dx,offset message                              
		int  21h                          

		mov  ah,4ch
		int  21h                          ;ç¨‹åºç»“æŸ

		end start
```


### å…³é”®æ¦‚å¿µ
* æ±‡ç¼–è¯­è¨€ï¼šç”¨æŒ‡ä»¤çš„åŠ©è®°ç¬¦ã€ç¬¦å·åœ°å€ã€æ ‡å·ã€ä¼ªæŒ‡ä»¤ç­‰ç¬¦å·ä¹¦å†™ç¨‹åºçš„è¯­è¨€ã€‚
* æ±‡ç¼–è¯­è¨€æºç¨‹åºï¼šç”¨æ±‡ç¼–è¯­è¨€ä¹¦å†™çš„ç¨‹åºã€‚
* æ±‡ç¼–ï¼šæŠŠæ±‡ç¼–è¯­è¨€æºç¨‹åºç¿»è¯‘æˆæœºå™¨è¯­è¨€ç¨‹åºçš„è¿‡ç¨‹ã€‚
* æ±‡ç¼–ç¨‹åºï¼šå®Œæˆæ±‡ç¼–è¿‡ç¨‹çš„ç³»ç»Ÿç¨‹åºã€‚
* è¯­å¥æ ¼å¼ï¼šæ±‡ç¼–è¯­è¨€è¯­å¥çš„æ ¼å¼
  * `â€¦`ä¸­çš„å‚æ•°å¿…éœ€ï¼Œå³é»˜è®¤å¿…éœ€
  * `[â€¦]`ä¸­çš„å‚æ•°å¯é€‰
  * `{â€¦|â€¦}`å¤šé€‰ä¸€(ç”±`|`åˆ†å‰²)
* å¸¸æ•°: æ•´æ•°å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡
* ä¼ªæŒ‡ä»¤ï¼šç”¨æ¥å¯¹æ±‡ç¼–ç¨‹åºè¿›è¡Œæ§åˆ¶ï¼Œä»¥ä½¿ç¨‹åºä¸­çš„æ•°æ®å®ç°æ¡ä»¶è½¬ç§»ã€åˆ—è¡¨ã€å­˜å‚¨ç©ºé—´åˆ†é…ç­‰å¤„ç†ã€‚å…¶æ ¼å¼ä¸æ±‡ç¼–æŒ‡ä»¤ä¸€æ ·ï¼Œä½†ä¸€èˆ¬ä¸äº§ç”Ÿç›®çš„ä»£ç ã€‚
* è¿ç®—ç¬¦: ç®—æœ¯è¿ç®—ç¬¦ç­‰
* æºç¨‹åºçš„ç»“æ„: ä»£ç ç»“æ„
* å®åœ°å€æ¨¡å¼/ä¿æŠ¤æ¨¡å¼ï¼šå®ï¼ˆåœ°å€ï¼‰æ¨¡å¼å°†æ•´ä¸ªç‰©ç†å†…å­˜çœ‹æˆåˆ†æ®µçš„åŒºåŸŸï¼Œç¨‹åºä»£ç å’Œæ•°æ®ä½äºä¸åŒåŒºåŸŸï¼Œç³»ç»Ÿç¨‹åºå’Œç”¨æˆ·ç¨‹åºæ²¡æœ‰åŒºåˆ«å¯¹å¾…ï¼Œè€Œä¸”æ¯ä¸€ä¸ªæŒ‡é’ˆéƒ½æ˜¯æŒ‡å‘çœŸå®çš„ç‰©ç†åœ°å€ï¼›ä¿æŠ¤æ¨¡å¼ä¸­ç‰©ç†å†…å­˜åœ°å€ä¸èƒ½ç›´æ¥è¢«ç¨‹åºè®¿é—®ï¼Œç¨‹åºå†…éƒ¨çš„åœ°å€ï¼ˆè™šæ‹Ÿåœ°å€ï¼‰è¦ç”±æ“ä½œç³»ç»Ÿè½¬åŒ–ä¸ºç‰©ç†åœ°å€å»è®¿é—®ï¼Œç¨‹åºå¯¹æ­¤ä¸€æ— æ‰€çŸ¥ã€‚
* å¤§ç«¯/å°ç«¯å­˜å‚¨: å¤§ç«¯å­˜å‚¨ï¼ˆå¸¸è¯†ï¼‰ç”¨äºç½‘ç»œï¼Œæœ‰åˆ©äºäººçœ‹ï¼Œå¦‚ 5678H è¡¨å¼å­˜å‚¨ä¸º 5678Hï¼›å°ç«¯å­˜å‚¨ï¼ˆåå¸¸è¯†ï¼‰ç”¨äº intel å¤„ç†å™¨ï¼Œæœ‰åˆ©äºç”µè„‘çœ‹ï¼Œå¦‚ 5678H è¡¨å¼å­˜å‚¨ä¸º 7856H
* 32ä½å’Œ16ä½ï¼š32ä½æœ€å…ˆå‡ºç°åœ¨80386å¤„ç†å™¨ï¼Œ16ä½æœ€å…ˆå‡ºç°åœ¨8086å¤„ç†å™¨ï¼ˆ8086åªæ”¯æŒå®æ¨¡å¼ï¼‰ï¼›ä»80386å¼€å§‹ï¼Œcpuæœ‰ä¸‰ç§å·¥ä½œæ–¹å¼ï¼šå®æ¨¡å¼ï¼Œä¿æŠ¤æ¨¡å¼å’Œè™šæ‹Ÿ8086æ¨¡å¼ã€‚åªæœ‰åœ¨åˆšåˆšå¯åŠ¨çš„æ—¶å€™æ˜¯å®æ¨¡å¼ï¼Œç­‰åˆ°æ“ä½œç³»ç»Ÿè¿è¡Œèµ·æ¥ä»¥åå°±è¿è¡Œåœ¨ä¿æŠ¤æ¨¡å¼ã€‚è™šæ‹Ÿ8086æ¨¡å¼æ˜¯è¿è¡Œåœ¨ä¿æŠ¤æ¨¡å¼ä¸­çš„å®æ¨¡å¼ï¼Œä¸ºäº†åœ¨32ä½ä¿æŠ¤æ¨¡å¼ä¸‹æ‰§è¡Œçº¯16ä½ç¨‹åºã€‚å®ƒä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„CPUæ¨¡å¼ï¼Œè¿˜å±äºä¿æŠ¤æ¨¡å¼ã€‚CPUå¯åŠ¨ç¯å¢ƒä¸º16ä½å®æ¨¡å¼ï¼Œä¹‹åå¯ä»¥åˆ‡æ¢åˆ°ä¿æŠ¤æ¨¡å¼ã€‚ä½†ä»ä¿æŠ¤æ¨¡å¼æ— æ³•åˆ‡æ¢å›å®æ¨¡å¼
* ECX å’Œ CXï¼šå‰è€…æ˜¯åè€…çš„æ‹“å±•ï¼Œä¸»è¦æ˜¯åœ¨32ä½CPUä¸­ä½¿ç”¨çš„ï¼ˆå½“ç„¶ï¼Œç”±äº Intel å‘ä¸‹å…¼å®¹ï¼Œæ‰€ä»¥ 64 ä½åº”è¯¥ä¹Ÿå¯ä»¥ï¼‰

### MASM
* `MASM 4.00`: è¿™æ˜¯æœ€å…ˆå¹¿æ³›ä½¿ç”¨çš„ä¸€ä¸ªMASMç‰ˆæœ¬ï¼Œé€‚ç”¨äºDOS ä¸‹çš„æ±‡ç¼–ç¼–ç¨‹ã€‚å®ƒå¾ˆç²¾å·§ï¼Œä½†ä½¿ç”¨èµ·æ¥ä¸æ˜¯å¾ˆæ™ºèƒ½åŒ–ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±ä¸€æ¿ä¸€çœ¼åœ°å†™å‡ºæ‰€æœ‰çš„ä¸œè¥¿ã€‚å¾ˆå¤šæ•™ç§‘ä¹¦ä¸Šè®²çš„8086 æ±‡ç¼–è¯­æ³•éƒ½æ˜¯é’ˆå¯¹è¿™ä¸ªç‰ˆæœ¬çš„ï¼Œå¯¹ç¨‹åºå‘˜æ¥è¯´ï¼Œå®ƒåªæ¯”ç”¨Debug æ–¹ä¾¿ä¸€ç‚¹ç‚¹ã€‚
* `MASM 5.00`: MASM 5.00 æ¯”4.00 åœ¨é€Ÿåº¦ä¸Šå¿«äº†å¾ˆå¤šï¼Œå¹¶å°†æ®µå®šä¹‰çš„ä¼ªæŒ‡ä»¤ç®€åŒ–ä¸ºç±»ä¼¼ .code ä¸.data ä¹‹ç±»çš„å®šä¹‰æ–¹å¼ï¼ŒåŒæ—¶å¢åŠ äº†å¯¹80386 å¤„ç†å™¨æŒ‡ä»¤çš„æ”¯æŒï¼Œå¯¹4.00 ç‰ˆæœ¬çš„å…¼å®¹æ€§å¾ˆå¥½ã€‚
* `MASM 5.10`: å¯¹ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ä¸ªç‰ˆæœ¬æœ€å¤§çš„è¿›æ­¥æ˜¯å¢åŠ äº†å¯¹@@æ ‡å·çš„æ”¯æŒã€‚è¿™æ ·ï¼Œç¨‹åºå‘˜å¯ä»¥ä¸å†ä¸ºæ ‡å·çš„èµ·åèŠ±æ‰å¾ˆå¤šæ—¶é—´ã€‚å¦å¤–ï¼ŒMASM 5.10 å¢åŠ äº†å¯¹OS/2 1.x çš„æ”¯æŒã€‚
* `MASM 5.10B`: 1989 å¹´æ¨å‡ºï¼Œæ¯”ä¸Šä¸€ä¸ªç‰ˆæœ¬æ›´ç¨³å®šã€æ›´å¿«ï¼Œå®ƒæ˜¯ä¼ ç»Ÿçš„DOS æ±‡ç¼–ç¼–è¯‘å™¨ä¸­æœ€å®Œå–„çš„ç‰ˆæœ¬ã€‚
* `MASM 6.00`: 1992 å¹´å‘å¸ƒï¼Œæœ‰äº†å¾ˆå¤šçš„æ”¹è¿›ã€‚ç¼–è¯‘å™¨å¯ä»¥ä½¿ç”¨æ‰©å±•å†…å­˜ï¼Œè¿™æ ·å¯ä»¥ç¼–è¯‘æ›´å¤§çš„æ–‡ä»¶ï¼Œå¯æ‰§è¡Œæ–‡ä»¶åç›¸åº”ä»Masm.exe æ”¹ä¸ºML.exeã€‚ä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸Šç”¨`*.asm`åŒæ—¶ç¼–è¯‘å¤šä¸ªæºæ–‡ä»¶ï¼Œæºç¨‹åºä¸­æ•°æ®ç»“æ„çš„ä½¿ç”¨å’Œå‘½ä»¤è¡Œå‚æ•°çš„è¯­æ³•ä¹Ÿæ›´åƒC çš„é£æ ¼ã€‚æœ€å¤§çš„æ”¹è¿›ä¹‹ä¸€æ˜¯å¼€å§‹æ”¯æŒ .if/.endif è¿™æ ·çš„é«˜çº§è¯­æ³•ï¼Œè¿™æ ·ï¼Œä½¿ç”¨å¤æ‚çš„æ¡ä»¶åˆ†æ”¯æ—¶å’Œç”¨é«˜çº§è¯­è¨€ä¹¦å†™ä¸€æ ·ç®€å•ï¼Œå¯ä»¥åšåˆ°å‡ åƒè¡Œçš„ä»£ç ä¸­ä¸å®šä¹‰ä¸€ä¸ªæ ‡å·ï¼›å¦å¤–å¢åŠ äº†invoke ä¼ªæŒ‡ä»¤æ¥ç®€åŒ–å¸¦å‚æ•°çš„å­ç¨‹åºè°ƒç”¨ã€‚è¿™ä¸¤ä¸ªæ”¹è¿›ä½¿æ±‡ç¼–ä»£ç çš„é£æ ¼è¶Šæ¥è¶ŠåƒCï¼Œå¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§æé«˜äº†å¾ˆå¤šã€‚
* `MASM 6.00A`: æœªå‘å”®çš„ç‰ˆæœ¬ã€‚
* `MASM 6.00B`: æœ€åä¸€ä¸ªæ”¯æŒOS/2 çš„MASM ç‰ˆæœ¬ï¼Œä¿®æ­£äº†ä¸Šä¸€ç‰ˆæœ¬ä¸­çš„ä¸€äº›é”™è¯¯ã€‚
* `MASM 6.10`: ä¿®æ­£äº†ä¸€äº›é”™è¯¯ï¼ŒåŒæ—¶å¢åŠ äº†/Sc é€‰é¡¹ï¼Œå¯ä»¥åœ¨äº§ç”Ÿçš„list æ–‡ä»¶ä¸­åˆ—å‡ºæ¯æ¡æŒ‡ä»¤ä½¿ç”¨çš„æ—¶é’Ÿå‘¨æœŸæ•°ã€‚
* `MASM 6.10A`: 1992 å¹´å‘å¸ƒï¼Œä¿®æ­£äº†ä¸€äº›å†…å­˜ç®¡ç†æ–¹é¢çš„é—®é¢˜ã€‚
* `MASM 6.11`: 1993 å¹´11 æœˆå‘å¸ƒï¼Œæ”¯æŒWindows NTï¼Œå¯ä»¥ç¼–å†™Win32 ç¨‹åºï¼ŒåŒæ—¶æ”¯æŒPentium æŒ‡ä»¤ï¼Œä½†ä¸æ”¯æŒMMXæŒ‡ä»¤é›†ã€‚
* `MASM 6.11C`: 1994 å¹´å‘å¸ƒï¼Œå¢åŠ äº†å¯¹Windows 95 VxD çš„æ”¯æŒã€‚
* `MASM 6.12`: 1997 å¹´8 æœˆå‘å¸ƒï¼Œå¢åŠ  .686ï¼Œ.686Pï¼Œ.MMX å£°æ˜å’Œå¯¹ç›¸åº”æŒ‡ä»¤çš„æ”¯æŒã€‚
* `MASM 6.13`: 1997 å¹´12 æœˆå‘å¸ƒï¼Œå¢åŠ äº† .K3D å£°æ˜ï¼Œå¼€å§‹æ”¯æŒAMD å¤„ç†å™¨çš„3D æŒ‡ä»¤ã€‚
* `MASM 6.14`: è¿™æ˜¯ä¸€ä¸ªå¾ˆå®Œå–„çš„ç‰ˆæœ¬ï¼Œå®ƒåœ¨ .XMMä¸­å¢åŠ äº†å¯¹Pentium IIIçš„SIMDæŒ‡ä»¤é›†çš„æ”¯æŒï¼Œç›¸åº”å¢åŠ äº†OWORDï¼ˆ16 å­—èŠ‚ï¼‰çš„å˜é‡ç±»å‹ã€‚
* `MASM 6.15`: 2000 å¹´4 æœˆå‘å¸ƒã€‚

### ç¼–è¯‘ã€é“¾æ¥å’Œè¿è¡Œç¨‹åº

#### è¿‡ç¨‹
![ç¼–è¯‘é“¾æ¥å’Œè¿è¡Œç¨‹åº.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/ç¼–è¯‘é“¾æ¥å’Œè¿è¡Œç¨‹åº.png)

#### æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆï¼Ÿ
![æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆ.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆ.png)
å…¶ä¸­EXEçš„æ–‡ä»¶å¤´`MZ`æ˜¯**Mark Zbikowski**çš„ç¼©å†™ï¼ŒMark Zbikowski æ›¾æ˜¯Microsoft é«˜çº§æ„æ¶å¸ˆå’Œæœ€æ—©çš„è®¡ç®—æœºé»‘å®¢ä¹‹ä¸€ï¼ŒDOS å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼çš„è®¾è®¡è€…ã€‚
![æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆ2.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/æ±‡ç¼–ç¨‹åºåšäº†ä»€ä¹ˆ2.png)

### åŸºæœ¬å…ƒç´ 
* `â€¦`ä¸­çš„å‚æ•°å¿…éœ€ï¼Œå³é»˜è®¤å¿…éœ€
* `[â€¦]`ä¸­çš„å‚æ•°å¯é€‰
* `{â€¦|â€¦}`å¤šé€‰ä¸€(ç”±`|`åˆ†å‰²)
   
#### æ•´æ•°å¸¸é‡
```
[{+|-}]digits[radix]
```
* `digits`æ˜¯ä¸€ä¸ªæ•´æ•°
* `radix`ï¼ˆåŸºæ•°åç¼€ï¼‰å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼ˆå¤§å°å†™å‡å¯ï¼‰:
  * `h`: åå…­è¿›åˆ¶
  * `b`: äºŒè¿›åˆ¶
  * `q/o`: å…«è¿›åˆ¶
  * `r`: ç¼–ç å®æ•°
  * `d`: åè¿›åˆ¶
  
  ä¾‹å¦‚ï¼š`26 26d 11010011b 42q 42o 1Ah 0A3h`

#### å­—ç¬¦ã€å­—ç¬¦ä¸²å¸¸é‡
```
'A'
"d"
'ABC'
"Goodnight, Gracie"
'4096'
"This isn't a test"
'Say "Goodnight," Gracie'
```

#### ç®—æœ¯è¿ç®—ç¬¦

| è¿ç®—ç¬¦  | åç§°       | ä¼˜å…ˆçº§ |
| `()`    | åœ†æ‹¬å·     | 1      |
| `+, - ` | å•ç›®åŠ ã€å‡ | 2      |
| `*, / ` | ä¹˜ã€é™¤     | 3      |
| `MOD`   | å–æ¨¡       | 3      |
| `+, -`  | åŠ ã€å‡     | 4      |

#### ä¿ç•™å­—
ä¿ç•™å­—ï¼šæœ‰ç‰¹æ®Šå«ä¹‰ï¼Œåªèƒ½ç”¨äºæ­£ç¡®çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­
* æŒ‡ä»¤åŠ©è®°ç¬¦ï¼Œä¾‹å¦‚ï¼š`MOV`ï¼Œ`ADD`ï¼Œ`MUL`
* ä¼ªæŒ‡ä»¤ï¼Œå‘Šè¯‰`MASM`å¦‚ä½•ç¼–è¯‘ç¨‹åºï¼Œå¦‚ï¼š`ASSUME`ï¼Œ`OFFSET`ï¼Œ`.data`ï¼Œ`.code`ï¼Œ`name PROC`
* å±æ€§ï¼Œä¸ºå˜é‡å’Œæ“ä½œæ•°æä¾›æœ‰å…³å°ºå¯¸åŠä½¿ç”¨æ–¹å¼ä¿¡æ¯ï¼Œå¦‚ï¼š`BYTE`ï¼Œ`WORD`
* è¿ç®—ç¬¦ï¼Œç”¨åœ¨**å¸¸é‡è¡¨è¾¾å¼**ä¸­ï¼Œå¦‚ï¼š`+`ï¼Œ`-`ï¼Œ`*`ï¼Œ`/`ã€‚
* é¢„å®šä¹‰ç¬¦å·ï¼Œä¾‹å¦‚`@data`ï¼Œåœ¨ç¼–è¯‘æ—¶è¿”å›æ•´æ•°å¸¸é‡å€¼ã€‚

#### æ ‡è¯†ç¬¦
æ ‡è¯†ç¬¦ï¼šç¨‹åºå‘˜é€‰æ‹©çš„åå­—ï¼Œç”¨æ¥è¯†åˆ«å˜é‡ã€å¸¸é‡ã€è¿‡ç¨‹æˆ–ä»£ç æ ‡å·ã€‚
* å¯åŒ…å«1ï½247ä¸ªå­—ç¬¦ã€‚
* å¤§å°å†™ä¸æ•æ„Ÿã€‚ï¼ˆæ±‡ç¼–å™¨åŠ `-Cp`å‚æ•°åˆ™å¤§å°å†™æ•æ„Ÿï¼‰
* ç¬¬ä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯å­—æ¯(`A-Z`å’Œ`a-z`)ã€ä¸‹åˆ’çº¿(`_`)ã€`@`ã€`?`æˆ–`$`ï¼Œåç»­å­—ç¬¦å¯ä»¥æ˜¯æ•°å­—ã€‚
* ä¸èƒ½ä¸ä¿ç•™å­—ç›¸åŒã€‚
* å°½é‡é¿å…ç”¨`@`å’Œ`_`ä½œä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå› ä¸ºå®ƒä»¬å³ç”¨äºæ±‡ç¼–å™¨ï¼Œä¹Ÿç”¨äºé«˜çº§è¯­è¨€ç¼–è¯‘å™¨ã€‚

#### æŒ‡ä»¤
æŒ‡ä»¤ï¼šç¨‹åºè¢«åŠ è½½è‡³å†…å­˜å¼€å§‹è¿è¡Œåï¼Œç”±å¤„ç†å™¨æ‰§è¡Œçš„è¯­å¥ã€‚
```
[æ ‡å·:] æŒ‡ä»¤åŠ©è®°ç¬¦ [æ“ä½œæ•°] [;æ³¨é‡Š]
```

ä¾‹å­ï¼š
1. 
   ```
   ;ä»£ç æ ‡å·
   target:
     mov ax,bx
     ...
     jmp target
   ```
2. 
   ```
   ;æ•°æ®æ ‡å·
   first BYTE 10
   ```

#### æ•°æ®å®šä¹‰
```
[åç§°] ç±»å‹ åˆå§‹å€¼[,åˆå§‹å€¼]â€¦
```

å…¶ä¸­ç±»å‹å¯ä»¥ä¸ºï¼š

| ç±»å‹   | ç”¨é€”                                     | æ—©æœŸç‰ˆæœ¬ |
|--------+------------------------------------------+----------|
| BYTE   | 8ä½æ— ç¬¦å·æ•´æ•°                            | DB       |
| SBYTE  | 8ä½æœ‰ç¬¦å·æ•´æ•°                            |          |
| WORD   | 16ä½æ— ç¬¦å·æ•´æ•°(å¯åœ¨å®æ¨¡å¼ä¸‹ç”¨ä½œè¿‘æŒ‡é’ˆ)   | DW       |
| SWORD  | 16ä½æœ‰ç¬¦å·æ•´æ•°                           |          |
| DWORD  | 32ä½æ— ç¬¦å·æ•´æ•°(å¯åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ç”¨ä½œè¿‘æŒ‡é’ˆ) | DD       |
| SDWORD | 32ä½æœ‰ç¬¦å·æ•´æ•°                           |          |
| FWORD  | 48ä½æ•´æ•°(å¯åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ç”¨ä½œè¿œæŒ‡é’ˆ)       |          |
| QWORD  | 64ä½æ•´æ•°                                 | DQ       |
| TBYTE  | 80ä½æ•´æ•°                                 | DT       |
| REAL4  | 32ä½IEEEçŸ­å®æ•°                           |          |
| REAL8  | 64ä½IEEEé•¿å®æ•°                           |          |
| REAL10 | 80ä½IEEEæ‰©å±•ç²¾åº¦å®æ•°                     |          |

ä¾‹å¦‚ï¼š
```
.data
value1 BYTE 10h
value2 BYTE ?
list1  BYTE 10,20,30,40
       BYTE 50,60,70,80
list2  BYTE 32,41h,00100010b,'a'
greeting BYTE "Good afternoon",0dh,0ah,0
array  WORD 5 DUP(?)	;5ä¸ªæœªåˆå§‹åŒ–çš„å€¼
value3 DWORD 12345678h
```

#### ç¬¦å·å¸¸é‡
ç¬¦å·å¸¸é‡ï¼šä¸å ç”¨ä»»ä½•å®é™…çš„å­˜å‚¨ç©ºé—´ã€‚

* ç­‰å·ä¼ªæŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š
  ```
  COUNT = 500
  ESC_key = 27
  array COUNT DUP(0)
  mov cx,COUNT
  mov al,ESC_key
  ```
* `EQU`ä¼ªæŒ‡ä»¤
* `TEXTEQU`ä¼ªæŒ‡ä»¤
* `($ - array)`ä¼ªæŒ‡ä»¤ï¼Œè®¡ç®—æ•°ç»„å’Œå­—ç¬¦ä¸²çš„å¤§å°ï¼Œä¾‹ï¼š
  ```
  list1 BYTE 10,20,30,40
  List1Size = ($ - list1)
  myString BYTE "This is a long string,"
           BYTE " Containing any number"
           BYTE " of characters",0dh,0ah
  MyString_len = ($ - myString)
  list2 WORD 1000h,2000h,3000h,4000h
  List2Size = ($ - list2)/2
  ```

### æ•°æ®ä¼ é€æŒ‡ä»¤â€”â€” MOV ç±»æŒ‡ä»¤

#### æ“ä½œæ•°ç±»å‹
* ç«‹å³æ“ä½œæ•°ï¼ˆimmediateï¼‰
  * `imm`: 8ã€16æˆ–32ä½ç«‹å³æ•°
  * `imm8`: 8ä½ç«‹å³æ•°ï¼ˆå­—èŠ‚ï¼‰
  * `imm16`: 16ä½ç«‹å³æ•°ï¼ˆå­—ï¼‰
  * `imm32`:  32ä½ç«‹å³æ•°ï¼ˆåŒå­—ï¼‰
* å¯„å­˜å™¨æ“ä½œæ•°ï¼ˆregisterï¼‰
  * `reg`: ä»»æ„çš„é€šç”¨å¯„å­˜å™¨
  * `sreg`: 16ä½æ®µå¯„å­˜å™¨CSã€DSã€SSã€ESã€FSã€GS
  * `r8`: AHã€ALã€BHã€BLã€CHã€CLã€DHã€DL
  * `r16`: AXã€BXã€CXã€DXã€SIã€DIã€SPã€BP
  * `r32`: EAXã€EBXã€ECXã€EDXã€ESIã€EDIã€ESPã€EBP
* å†…å­˜æ“ä½œæ•°ï¼ˆmemoryï¼‰
  * `mem`: 8ã€16æˆ–32ä½å†…å­˜æ“ä½œæ•°
* å…¶å®ƒçº¦å®š
  * `r/m8`: 8ä½æ“ä½œæ•°ï¼ˆ8ä½é€šç”¨å¯„å­˜å™¨æˆ–å†…å­˜å­—èŠ‚ï¼‰
  * `r/m16`: 16ä½æ“ä½œæ•°ï¼ˆ16ä½é€šç”¨å¯„å­˜å™¨æˆ–å†…å­˜å­—ï¼‰
  * `r/m32`: 32ä½æ“ä½œæ•°ï¼ˆ32ä½é€šç”¨å¯„å­˜å™¨æˆ–å†…å­˜åŒå­—ï¼‰

#### ç›´æ¥å†…å­˜æ“ä½œæ•°
![ç›´æ¥å†…å­˜æ“ä½œæ•°.png](http://wsxq12.55555.io/16ä½æ±‡ç¼–ç¨‹åºè®¾è®¡/ç›´æ¥å†…å­˜æ“ä½œæ•°.png)

#### `MOV`

```
mov destination,source

mov reg,reg
mov mem,reg
mov reg,mem
mov mem,imm
mov reg,imm
```

ç±»ä¼¼ Cè¯­è¨€ä¸­`destination=source`

MOVæŒ‡ä»¤éœ€è¦éµå¾ªçš„è§„åˆ™ï¼š
* ä¸¤ä¸ªæ“ä½œæ•°çš„å°ºå¯¸å¿…é¡»ä¸€è‡´ã€‚
* ä¸¤ä¸ªæ“ä½œæ•°ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜æ“ä½œæ•°ã€‚
* ç›®çš„æ“ä½œæ•°ä¸èƒ½æ˜¯CSï¼ŒEIPå’ŒIPã€‚
* ç«‹å³æ•°ä¸èƒ½ç›´æ¥é€è‡³æ®µå¯„å­˜å™¨ã€‚
* æ®µå¯„å­˜å™¨ä»…ç”¨äºå®åœ°å€æ¨¡å¼ï¼ˆå³80386ä¸­çš„ä¿æŠ¤æ¨¡å¼ä¸‹ä¸è¡Œï¼‰ä¸‹è¿è¡Œçš„ç¨‹åºã€‚
* å†…å­˜ä¹‹é—´çš„ç§»åŠ¨é€šè¿‡å¯„å­˜å™¨æš‚å­˜ã€‚å¦‚ï¼š
  ```
  .data
  var1 WORD ?
  var2 WORD ?
  .code
  mov ax,var1
  mov var2,ax
  ```

#### `MOVZX`
move with zero-extend
```
movzx r32,r/m8
movzx r32,r/m16
movzx r16,r/m8

```

#### `MOVSX`
move with sign-extend
```
movsx r32,r/m8
movsx r32,r/m16
movsx r16,r/m8

```

#### `XCHG`
exchange data: äº¤æ¢ä¸¤ä¸ªæ“ä½œæ•°çš„å†…å®¹ã€‚
```
xchg reg,reg
xchg reg,mem
xchg mem,reg
```

### åŠ å‡æ³•ç±»æŒ‡ä»¤
#### `INC`å’Œ`DEC`
* å«ä¹‰ï¼šincrementå’Œdecrementï¼ŒåŠ 1ã€å‡1ã€‚
* æ ¼å¼ï¼š
  ```
  inc reg/mem
  dec reg/mem
  ```
* ä¾‹å­ï¼š
  ```
  .data
  myWord WORD 1000h
  .code
  inc myWord		; 1001h
  mov bx,myWord
  dec bx		; 1000h
  ```
* å½±å“çš„æ ‡å¿—ä½ï¼šINCå’ŒDECæŒ‡ä»¤ä¸å½±å“è¿›ä½æ ‡å¿—

#### `ADD`
* å«ä¹‰ï¼šå°†åŒå°ºå¯¸çš„æºæ“ä½œæ•°å’Œç›®çš„æ“ä½œæ•°ç›¸åŠ ï¼Œç»“æœåœ¨ç›®çš„æ“ä½œæ•°ä¸­ï¼ˆä¸æ”¹å˜æºæ“ä½œæ•°ï¼‰ã€‚
* æ ¼å¼ï¼šä¸MOVæŒ‡ä»¤ç›¸åŒã€‚
  ```
  add ç›®çš„æ“ä½œæ•°,æºæ“ä½œæ•°
  ```
* ä¾‹ï¼š
  ```
  .data
  var1 DWORD 10000h
  var2 DWORD 20000h
  .code
  mov eax,var1
  add eax,var2	; 30000h
  ```
  
#### `SUB`
* å«ä¹‰ï¼šå°†æºæ“ä½œæ•°ä»ç›®çš„æ“ä½œæ•°ä¸­å‡æ‰ï¼Œç»“æœåœ¨ç›®çš„æ“ä½œæ•°ä¸­ï¼ˆä¸æ”¹å˜æºæ“ä½œæ•°ï¼‰ã€‚
* æ ¼å¼ï¼šä¸MOVã€ADDæŒ‡ä»¤ç›¸åŒã€‚
  ```
  sub ç›®çš„æ“ä½œæ•°,æºæ“ä½œæ•°
  ```
* ä¾‹ï¼š
  ```
  .data
  var1 DWORD 30000h
  var2 DWORD 10000h
  .code
  mov eax,var1
  sub eax,var2	; 20000h
  
  ```
* å½±å“çš„æ ‡å¿—ä½ï¼š**CFã€ZFã€SFã€OFã€AFã€PF**

#### `NEG`
* å«ä¹‰ï¼šnegateï¼Œæ±‚è´Ÿã€‚å°†æ“ä½œæ•°æŒ‰ä½å–åã€æœ«ä½åŠ 1ã€‚
* æ ¼å¼ï¼š
  ```
  neg reg
  neg mem
  ```
* å½±å“çš„æ ‡å¿—ä½ï¼š**CFã€ZFã€SFã€OFã€AFã€PF**

#### æ ‡å¿—ä½
* é›¶æ ‡å¿—å’Œç¬¦å·æ ‡å¿—
* è¿›ä½æ ‡å¿—ï¼ˆæ— ç¬¦å·ç®—æœ¯è¿ç®—ï¼‰ï¼šINCå’ŒDECæŒ‡ä»¤ä¸å½±å“è¿›ä½æ ‡å¿—ã€‚
* æº¢å‡ºæ ‡å¿—ï¼ˆæœ‰ç¬¦å·ç®—æœ¯è¿ç®—ï¼‰
  ```
  OF=Cğ‘›âŠ•C(ğ‘›âˆ’1)
  ```
  å…¶ä¸­ï¼ŒCnä¸ºç¬¦å·ä½äº§ç”Ÿçš„è¿›ä½ï¼Œå³æ ‡å¿—ä½CFï¼› Cn-1ä¸ºæœ€é«˜æœ‰æ•ˆä½å‘ç¬¦å·ä½äº§ç”Ÿçš„è¿›ä½ã€‚

#### ä¾‹å­ç¨‹åº
```
.386
.MODEL flat, stdcall
.STACK 4096
ExitProcess PROTO,dwExitCode:DWORD
.data
Rval SDWORD ?
Xval SDWORD 26
Yval SDWORD 30
Zval SDWORD 40
.code
main PROC
	mov ax,1000h   ; INC and DEC
	inc ax	    ; 1001h
	dec ax	    ; 1000h
	; Expression: Rval = -Xval + (Yval - Zval)
	mov  eax,Xval
	neg  eax	    ; -26
	mov  ebx,Yval
	sub  ebx,Zval  ; -10
	add  eax,ebx
	mov  Rval,eax  ; -36
	; Zero flag example:
	mov cx,1
	sub cx,1		; ZF = 1
	mov ax,0FFFFh
	inc ax		; ZF = 1
	; Sign flag example:
	mov cx,0
	sub cx,1		; SF = 1
	mov ax,7FFFh
	add ax,2		; SF = 1
	; Carry flag example:
	mov al,0FFh
	add al,1		; CF = 1, AL = 00
	; Overflow flag example:
	mov  al,+127
	add  al,1		; OF = 1
	mov  al,-128
	sub  al,1		; OF = 1
	INVOKE ExitProcess,0
main ENDP
END main
```

### å’Œæ•°æ®ç›¸å…³çš„æ“ä½œç¬¦
#### `OFFSET`
* OFFSET æ“ä½œç¬¦è¿”å›æ•°æ®æ ‡å·çš„åç§»åœ°å€ï¼ˆæ ‡å·è·æ•°æ®æ®µå¼€å§‹çš„è·ç¦»ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚
* ä¿æŠ¤æ¨¡å¼ä¸‹åç§»æ€»æ˜¯32ä½çš„ã€‚
* å®æ¨¡å¼ä¸‹åç§»åªæœ‰16ä½ã€‚
* å¯ä¸ç›´æ¥åç§»æ“ä½œæ•°è”åˆä½¿ç”¨

ä¾‹å¦‚ï¼ˆå‡è®¾`bVal`ä½äº`00303000h`å¤„ï¼‰:
```
.data
bVal  BYTE  ?
wVal  WORD  ?
dVal1 DWORD ?
dVal2 DWORD ?
.code
â€¦â€¦
mov esi,OFFSET bVal	  ; ESI = 00303000
mov esi,OFFSET wVal	  ; ESI = 00303001
mov esi,OFFSET dVal1	; ESI = 00303003
mov esi,OFFSET dVal2	; ESI = 00303007
mov esi,OFFSET bVal + 1
â€¦â€¦
```

#### `PTR`
ç”¨æ¥é‡è½½æ“ä½œæ•°çš„é»˜è®¤å°ºå¯¸ã€‚

å¿…é¡»å’Œä»¥ä¸‹æ ‡å‡†æ•°æ®ç±»å‹è”åˆä½¿ç”¨ï¼šBYTEï¼ŒSBYTEï¼ŒWORDï¼ŒSWORDï¼ŒDWORDï¼ŒSDWORDï¼ŒFWORDï¼ŒQWORDï¼ŒTBYTE

ä¾‹å¦‚ï¼š
```
.data
myDouble DWORD 12345678h
.code
mov ax, myDouble			; é”™è¯¯
mov ax, WORD PTR myDouble		; ax = 5678h
mov ax, WORD PTR [myDouble+2]	; ax = 1234h
mov bl, BYTE PTR myDouble		; bl = 78h
```

#### `TYPE`
è¿”å›æŒ‰å­—èŠ‚è®¡ç®—çš„å˜é‡çš„å•ä¸ªå…ƒç´ çš„å¤§å°ã€‚
ä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼š
```
.data
var1 BYTE ?
var2 WORD ?
var3 DWORD ?
var4 QWORD ?
```
åˆ™æœ‰ï¼š

| è¡¨è¾¾å¼    | å€¼ |
| TYPE var1 | 1  |
| TYPE var2 | 2  |
| TYPE var3 | 4  |
| TYPE var4 | 8  |

#### `LENGTHOF`
è®¡ç®—æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚ä¾‹å¦‚ï¼š
```
.data
byte1    BYTE 10,20,30
array1   WORD 30 DUP(?),0,0
array2   WORD 5 DUP(3 DUP(?))
arrar3   DWORD 1,2,3,4
digitStr BYTE "12345678",0
```
åˆ™æœ‰ï¼š

| è¡¨è¾¾å¼            | å€¼   |
| LENGTHOF byte1    | 3    |
| LENGTHOF array1   | 30+2 |
| LENGTHOF array2   | 5Ã—3  |
| LENGTHOF array3   | 4    |
| LENGTHOF digitStr | 9    |

æ³¨æ„å¦‚ä¸‹ä»£ç ï¼š

```
pitches WORD 0960H,0960H,0960H,0960H,0960H,0960H,0BB8H,0960H,0834H,0960H
        WORD 0BB8H,0CE4H,0BB8H,0960H,0960H,0BB8H,0960H,0BB8H,0CE4H,0E10H
        WORD 0BB8H,0CE4H,0BB8H,0BB8H,0CE4H,1068H,0E10H,0CE4H,0834H,0834H
        WORD 0960H,0BB8H,0834H,0960H,0960H,0BB8H,0CE4H,0BB8H,0960H,0960H
        WORD 0BB8H,0CE4H,0BB8H,0960H,0BB8H,0CE4H,0BB8H,1068H,0E10H,0CE4H
        WORD 0BB8H,0E10H
pitches_len=( $ - pitches)/2 ; =52ï¼Œå³æ­£ç¡®çš„
pitches_len=LENGTHOF pitches ; =10ï¼Œå³é”™è¯¯çš„
```

#### `SIZEOF`
SIZEOFè¿”å›å€¼ï¼LENGTHOFè¿”å›å€¼Ã—TYPEè¿”å›å€¼ã€‚ä¾‹å¦‚ä¸‹ä»£ç ï¼š
```
.data
intArray WORD 32 DUP(0)
```
åˆ™æœ‰ï¼š

| è¡¨è¾¾å¼            | å€¼ |
| TYPE intArray     | 2  |
| LENGTHOF intArray | 32 |
| SIZEOF intArray   | 64 |

### é—´æ¥å¯»å€
#### é—´æ¥æ“ä½œæ•°ï¼ˆå¯„å­˜å™¨é—´æ¥å¯»å€ï¼‰
ç”¨å¯„å­˜å™¨ä½œä¸ºæŒ‡é’ˆï¼Œé€šè¿‡æ”¹å˜æŒ‡é’ˆå¯„å­˜å™¨çš„å€¼æ¥è®¿é—®æ•°ç»„ä¸­çš„ä¸åŒå…ƒç´ ï¼Œè¿™ç§å¯»å€æ–¹å¼ç§°ä¸º**å¯„å­˜å™¨é—´æ¥å¯»å€**ï¼Œå­˜æ”¾åœ°å€çš„å¯„å­˜å™¨ç§°ä¸º**é—´æ¥æ“ä½œæ•°**

**é—´æ¥æ“ä½œæ•°**åªèƒ½ç”¨SIï¼ŒDIï¼ŒBXï¼ŒBPã€‚é€šå¸¸å°½é‡é¿å…ä½¿ç”¨BPï¼ˆBPå¸¸ç”¨æ¥å¯»å€å †æ ˆè€Œä¸æ˜¯æ•°æ®æ®µï¼‰ï¼ˆ32ä½æ±‡ç¼–ï¼Œå³ä¿æŠ¤æ¨¡å¼ä¸­å¯ä»¥æ˜¯ä»»ä½•ç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥çš„32ä½é€šç”¨å¯„å­˜å™¨ï¼ˆEAXï¼ŒEBXï¼ŒECXï¼ŒEDXï¼ŒESIï¼ŒEDIï¼ŒEBPã€ESPï¼‰ã€‚ä¾‹å¦‚ï¼š
```
.data
val1 BYTE 10h
.code
main proc
  mov si,OFFSET val1
  mov AL,[si] ;AL=10h
```

PTRä¸é—´æ¥æ“ä½œæ•°çš„è”åˆä½¿ç”¨ä¾‹ï¼š

```
inc [esi]	; error: operand must have size
inc BYTE PTR [esi]
```

#### å˜å€æ“ä½œæ•°ï¼ˆå¯„å­˜å™¨ç›¸å¯¹å¯»å€ï¼‰
ä¾‹ï¼ˆ32ä½ï¼‰ï¼š

```
.data
arrayB BYTE 10h,20h,30h
.code
mov esi,0
mov al,[arrayB + esi]	; AL = 10h
mov al,arrayB[esi]	; åŒä¸Šï¼Œå¦ä¸€ç§æ ¼å¼
mov esi,OFFSET arrayB
mov al,[esi]			; AL = 10h
mov al,[esi+1]		; AL = 20h
mov al,[esi+2]		; AL = 30h
```
å®æ¨¡å¼ï¼ˆå³16ä½æ±‡ç¼–ï¼‰ä¸‹åªèƒ½ä½¿ç”¨SIï¼ŒDIï¼ŒBXï¼ŒBPå¯„å­˜å™¨ã€‚ï¼ˆå°½é‡é¿å…ä½¿ç”¨BPå¯„å­˜å™¨ï¼‰

### JMPå’ŒLOOPæŒ‡ä»¤
æ§åˆ¶è½¬ç§»ï¼ˆè·³è½¬ï¼‰æˆ–åˆ†æ”¯æ˜¯ä¸€ç§æ”¹å˜ç¨‹åºæ‰§è¡Œé¡ºåºçš„æ–¹æ³•ã€‚
æ§åˆ¶è½¬ç§»å¯åˆ†ä¸ºä¸¤ç§ï¼š
æ— æ¡ä»¶è½¬ç§»ï¼šä»¥JMPæŒ‡ä»¤ä¸ºä¾‹
æ¡ä»¶è½¬ç§»ï¼šä»¥LOOPæŒ‡ä»¤ä¸ºä¾‹

#### `JMP`
ä¾‹ï¼šåˆ›å»ºä¸€ä¸ªå¾ªç¯

```
top:
		.
		.
		.
		jmp top		; repeat the endless loop
```

#### `LOOP`
æ ¼å¼ï¼š
```
LOOP ç›®çš„åœ°å€
```

LOOPæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ï¼š`ECX-=1; ECX=0?é€€å‡ºå¾ªç¯:è·³è½¬åˆ°ç›®çš„åœ°å€; ECX-=1; ....`

* **åœ¨å®åœ°å€æ¨¡å¼ä¸‹ï¼Œç”¨åšé»˜è®¤å¾ªç¯è®¡æ•°å™¨çš„æ˜¯CXè€Œä¸æ˜¯ECX**ã€‚å¦‚ï¼š
  ```
      mov  ax,0
      mov  cx,5
  L1: inc  ax
      loop L1
  ```
  å¾ªç¯ç»“æŸæ—¶ï¼ŒAX=5  ECX=0

* åœ¨ 32 ä½ CPU ä¸­çš„ä»»ä½•æ¨¡å¼ä¸‹ï¼ŒLOOPDæŒ‡ä»¤éƒ½ä½¿ç”¨ECXä½œä¸ºå¾ªç¯è®¡æ•°å™¨ï¼›LOOPWéƒ½ä½¿ç”¨CXä½œä¸ºå¾ªç¯è®¡æ•°å™¨ã€‚
* å¾ªç¯çš„ç›®çš„åœ°å€ä¸å½“å‰åœ°å€åªèƒ½åœ¨ç›¸è·-128åˆ°+127å­—èŠ‚çš„èŒƒå›´ä¹‹å†…ã€‚æœºå™¨æŒ‡ä»¤å¹³å‡3å­—èŠ‚å·¦å³ï¼Œå› æ­¤ä¸€ä¸ªå¾ªç¯å¹³å‡æœ€å¤šåªèƒ½åŒ…å«å¤§çº¦**42**æ¡æŒ‡ä»¤ã€‚
* å¾ªç¯å¯ä»¥åµŒå¥—ã€‚å¦‚ï¼š
  ```
  .data
  count DWORD ?
  .code
      mov ecx,100
  L1: mov count,ecx
      mov ecx,20
  L2: .
      .
      loop L2
      mov ecx,count
      loop L1
  ```

### è¿‡ç¨‹â€”â€” PROC ç›¸å…³æŒ‡ä»¤
#### ä¸å¤–éƒ¨åº“é“¾æ¥
é“¾æ¥åº“ï¼šåŒ…å«å·²ç»ç¼–è¯‘æˆæœºå™¨ç çš„**è¿‡ç¨‹**çš„æ–‡ä»¶ã€‚

**ç¼–è¯‘æºæ–‡ä»¶->äº§ç”Ÿç›®æ ‡æ–‡ä»¶->æ’å…¥åˆ°åº“ä¸­**

é“¾æ¥åº“å¦‚ä½•å·¥ä½œï¼Ÿå‡è®¾ç¨‹åºè¦è°ƒç”¨`Irvine32.inc`æ–‡ä»¶ä¸­çš„åä¸º`WriteString`çš„è¿‡ç¨‹åœ¨æ§åˆ¶å°ä¸Šæ˜¾ç¤ºå­—ç¬¦ä¸²ï¼Œåˆ™ï¼š
1. ç¨‹åºä¸­è¦ç”¨ PROTO ä¼ªæŒ‡ä»¤å£°æ˜è¦è°ƒç”¨çš„ç¨‹åºã€‚`Irvine32.inc`ä¸­åŒ…å«è¯­å¥`WriteString PROTO`
1. ç”¨ä¸€æ¡ CALL æŒ‡ä»¤æ‰§è¡Œ WriteString è¿‡ç¨‹: `call WriteString`
1. å½“ç¨‹åºè¢«ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¸º CALL æŒ‡ä»¤çš„ç›®æ ‡åœ°å€ç•™å‡ºç©ºç™½ï¼Œè¯¥ç©ºç™½å°†ç”±é“¾æ¥å™¨å¡«å……ã€‚
1. é“¾æ¥å™¨åœ¨é“¾æ¥åº“ä¸­æŸ¥æ‰¾WriteStringè¿™ä¸ªåå­—ï¼Œä»åº“ä¸­æŠŠåˆé€‚çš„æœºå™¨æŒ‡ä»¤æ‹·è´åˆ°ç¨‹åºçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå¹¶æŠŠWriteStringçš„åœ°å€æ’å…¥åˆ°CALLæŒ‡ä»¤ä¸­ã€‚

é“¾æ¥å™¨çš„å‘½ä»¤è¡Œé€‰é¡¹
ä¾‹ï¼š
```
Link32 /subsystem:windows HelloWin.obj user32.lib kernel32.lib
```
**é“¾æ¥æ—¶å¼•å…¥`user32.lib`å’Œ`kernel32.lib`æ–‡ä»¶->è¿è¡Œæ—¶å°±ä¼šå¼•ç”¨`user32.dll`å’Œ`kernel32.dll`**

kernel32.libå¯ä»¥åœ¨Microsoft Windowså¹³å°è½¯ä»¶å¼€å‘åŒ…ï¼ˆplatform SDKï¼‰ä¸­æ‰¾åˆ°ï¼Œå®ƒåŒ…å«äº†å­˜å‚¨åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ â€”â€” kernel32.dll ä¸­çš„æ“ä½œç³»ç»Ÿå‡½æ•°çš„é“¾æ¥ä¿¡æ¯ã€‚


å­˜åœ¨çš„é—®é¢˜ï¼š
1. `.inc`ã€`.obj`ã€`.dll`æ–‡ä»¶çš„ä½œç”¨ä¸è”ç³»ï¼Ÿ




## ç»å…¸ä¾‹å­
### æ•´æ•°æ•°ç»„æ±‚å’Œ
```
; This program sums an array of words. (SumArray.asm)
.386
.MODEL flat, stdcall
.STACK 4096
ExitProcess PROTO,dwExitCode:DWORD
.data
intarray WORD 100h,200h,300h,400h
.code
main PROC
	mov  edi,OFFSET intarray	; address of intarray
	mov  ecx,LENGTHOF intarray	; loop counter
	mov  ax,0				; zero the accumulator
L1:
	add  ax,[edi]			; add an integer
	add  edi,TYPE intarray   	; point to next integer
	loop L1				; repeat until ECX = 0
	INVOKE ExitProcess,0
main ENDP
END main
```

### æ‹·è´å­—ç¬¦ä¸²
```
TITLE Copying a String                  (CopyStr.asm)
; This program copies a string.
INCLUDE Irvine32.inc
.data
source  BYTE  "This is the source string",0
target  BYTE  SIZEOF source DUP(0),0
.code
main PROC
	mov  esi,0			; index register
	mov  ecx,SIZEOF source	; loop counter
L1:
	mov  al,source[esi]	; get a character from source
	mov  target[esi],al	; store it in the target
	inc  esi			; move to next character
	loop L1			; repeat for entire string
	INVOKE ExitProcess,0
main ENDP
END main
```

## é“¾æ¥
<!-- link start -->

<!-- link end -->

## ç¼©ç•¥è¯­
<!-- abbreviations start -->

* **AF**: Auxiliary carry Flagï¼ˆè¾…åŠ©è¿›ä½æ ‡å¿—ï¼‰
* **AH**: Accumulator register Highï¼ˆå¯„å­˜å™¨ A é«˜ä½ï¼‰
* **AL**: Accumulator register Lowï¼ˆå¯„å­˜å™¨ A ä½ä½ï¼‰
* **AX**: Accumulator register ï¼ˆå¯„å­˜å™¨ Aï¼‰
* **BH**: Base register Highï¼ˆå¯„å­˜å™¨ B é«˜ä½ï¼‰
* **BIU**: Bus Interface Unitï¼ˆæ€»çº¿æ¥å£å•å…ƒï¼‰
* **BL**: Base register Lowï¼ˆå¯„å­˜å™¨ B ä½ä½ï¼‰
* **BP**: Base Pointer
* **BX**: Base registerï¼ˆå¯„å­˜å™¨ Bï¼‰
* **CF**: Carry Flagï¼ˆè¿›ä½æ ‡å¿—ï¼‰
* **CH**: Count register Highï¼ˆå¯„å­˜å™¨ C é«˜ä½ï¼‰
* **CL**: Count register Lowï¼ˆå¯„å­˜å™¨ C ä½ä½ï¼‰
* **CS**: Code Segmentï¼ˆä»£ç æ®µï¼‰
* **CX**: Count registerï¼ˆå¯„å­˜å™¨ Cï¼‰
* **DB**: Define Byte
* **DD**: Define Dword
* **DEC**: DECrementï¼ˆé€’å‡ï¼‰
* **DH**: Data register Highï¼ˆå¯„å­˜å™¨ D é«˜ä½ï¼‰
* **DI**: Destination Index
* **DL**: Data register Lowï¼ˆå¯„å­˜å™¨ D ä½ä½ï¼‰
* **DQ**: Define QWORD
* **DS**: Data Segment
* **DT**: Define TBYTE
* **DUP**: DUPlicate
* **DW**: Define WORD
* **DWORD**: Double WORD
* **DX**: Data registerï¼ˆå¯„å­˜å™¨ Dï¼‰
* **EAX**: Extented AX
* **EBP**: Extented BP
* **EBX**: Extented BX
* **ECX**: Extented CX
* **EDI**: Extented DI
* **EDX**: Extented DX
* **EIP**: Extented IP
* **ENDP**: END Process
* **ENDS**: END Segment
* **EQU**: EQUal
* **ES**: Extra Segment
* **ESI**: Extented SI
* **ESP**: Extented SP
* **EU**: Execute Unit
* **EXE**: EXEcute
* **FS**: Extra Segment
* **FWORD**: Far WORD
* **GS**: Extra Segment
* **IA**: Intel Architecture
* **INC**: INCrement
* **INT**: INTerrupt
* **IO**: Input Output
* **IP**: Instruction Pointer
* **JMP**: JuMP
* **LOOPD**: LOOP DWORD
* **LOOPW**: LOOP WORD
* **MOV**: MOVe
* **MOVSX**: MOVe with Sign-eXtend
* **MOVZX**: MOVe with Zero-eXtend
* **MUL**: MULtiplication
* **MZ**: Mark Zbikowski
* **NEG**: NEGative
* **NT**: Windows New Technology (Windows NT)
* **OF**: Overflow Flag
* **OV**: OVerflow
* **PARA**: PARAgraph
* **PF**: Parity Flag
* **PROC**: PROCess
* **PROTO**: PROTOtype
* **PTR**: PoinTeR
* **QWORD**: Quadruple WORD
* **SBYTE**: Sign BYTE
* **SDWORD**: Sign DWORD
* **SF**: Sign Flag
* **SI**: Source Index
* **SP**: Stack Pointer
* **SS**: Stack Segment
* **SUB**: SUBtract
* **SWORD**: Sign WORD
* **TBYTE**: TB
* **XCHG**: eXCHanGe data
* **ZF**: Zero Flag
* **AMD**: Advanced Micro Devicesï¼ˆè¶…å¾®åŠå¯¼ä½“å…¬å¸ï¼‰
* **ASCII**: American Standard Code for Information Interchange
* **BIOS**: Basic Input Output System
* **CPU**: Central Processing Unit
* **DOS**: Disk Operating System
* **IEEE**: Institute of Electrical and Electronics Engineers
* **KB**: Keyboard
* **KB**: KiloByte
* **KB**: Knowledge Base
* **MB**: MegaByte
* **OS**: Operating System
* **SDK**: Software Development Kit
* **SIMD**: Single Instruction, Multiple Data
<!-- abbreviations end -->

*[AMD]: Advanced Micro Devicesï¼ˆè¶…å¾®åŠå¯¼ä½“å…¬å¸ï¼‰
*[ASCII]: American Standard Code for Information Interchange
*[BIOS]: Basic Input Output System
*[CPU]: Central Processing Unit
*[DOS]: Disk Operating System
*[IEEE]: Institute of Electrical and Electronics Engineers
*[KB]: Keyboard
*[KB]: KiloByte
*[KB]: Knowledge Base
*[MB]: MegaByte
*[OS]: Operating System
*[SDK]: Software Development Kit
*[SIMD]: Single Instruction, Multiple Data
*[AF]: Auxiliary carry Flagï¼ˆè¾…åŠ©è¿›ä½æ ‡å¿—ï¼‰
*[AH]: Accumulator register Highï¼ˆå¯„å­˜å™¨ A é«˜ä½ï¼‰
*[AL]: Accumulator register Lowï¼ˆå¯„å­˜å™¨ A ä½ä½ï¼‰
*[AX]: Accumulator register ï¼ˆå¯„å­˜å™¨ Aï¼‰
*[BH]: Base register Highï¼ˆå¯„å­˜å™¨ B é«˜ä½ï¼‰
*[BIU]: Bus Interface Unitï¼ˆæ€»çº¿æ¥å£å•å…ƒï¼‰
*[BL]: Base register Lowï¼ˆå¯„å­˜å™¨ B ä½ä½ï¼‰
*[BP]: Base Pointer
*[BX]: Base registerï¼ˆå¯„å­˜å™¨ Bï¼‰
*[CF]: Carry Flagï¼ˆè¿›ä½æ ‡å¿—ï¼‰
*[CH]: Count register Highï¼ˆå¯„å­˜å™¨ C é«˜ä½ï¼‰
*[CL]: Count register Lowï¼ˆå¯„å­˜å™¨ C ä½ä½ï¼‰
*[CS]: Code Segmentï¼ˆä»£ç æ®µï¼‰
*[CX]: Count registerï¼ˆå¯„å­˜å™¨ Cï¼‰
*[DB]: Define Byte
*[DD]: Define Dword
*[DEC]: DECrementï¼ˆé€’å‡ï¼‰
*[DH]: Data register Highï¼ˆå¯„å­˜å™¨ D é«˜ä½ï¼‰
*[DI]: Destination Index
*[DL]: Data register Lowï¼ˆå¯„å­˜å™¨ D ä½ä½ï¼‰
*[DQ]: Define QWORD
*[DS]: Data Segment
*[DT]: Define TBYTE
*[DUP]: DUPlicate
*[DW]: Define WORD
*[DWORD]: Double WORD
*[DX]: Data registerï¼ˆå¯„å­˜å™¨ Dï¼‰
*[EAX]: Extented AX
*[EBP]: Extented BP
*[EBX]: Extented BX
*[ECX]: Extented CX
*[EDI]: Extented DI
*[EDX]: Extented DX
*[EIP]: Extented IP
*[ENDP]: END Process
*[ENDS]: END Segment
*[EQU]: EQUal
*[ES]: Extra Segment
*[ESI]: Extented SI
*[ESP]: Extented SP
*[EU]: Execute Unit
*[EXE]: EXEcute
*[FS]: Extra Segment
*[FWORD]: Far WORD
*[GS]: Extra Segment
*[IA]: Intel Architecture
*[INC]: INCrement
*[INT]: INTerrupt
*[IO]: Input Output
*[IP]: Instruction Pointer
*[JMP]: JuMP
*[LOOPD]: LOOP DWORD
*[LOOPW]: LOOP WORD
*[MOV]: MOVe
*[MOVSX]: MOVe with Sign-eXtend
*[MOVZX]: MOVe with Zero-eXtend
*[MUL]: MULtiplication
*[MZ]: Mark Zbikowski
*[NEG]: NEGative
*[NT]: Windows New Technology (Windows NT)
*[OF]: Overflow Flag
*[OV]: OVerflow
*[PARA]: PARAgraph
*[PF]: Parity Flag
*[PROC]: PROCess
*[PROTO]: PROTOtype
*[PTR]: PoinTeR
*[QWORD]: Quadruple WORD
*[SBYTE]: Sign BYTE
*[SDWORD]: Sign DWORD
*[SF]: Sign Flag
*[SI]: Source Index
*[SP]: Stack Pointer
*[SS]: Stack Segment
*[SUB]: SUBtract
*[SWORD]: Sign WORD
*[TBYTE]: TB
*[XCHG]: eXCHanGe data
*[ZF]: Zero Flag


